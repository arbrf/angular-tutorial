 <h3>Shared Service Across Components</h3>
    <app-counter-a></app-counter-a>
    <app-counter-b></app-counter-b>
    <p><em>Both components use the same CounterService instance.</em></p>

<!-- ===============================
     TEMPLATE REFERENCE VARIABLES (#var)
================================== -->
<h3>Template Reference Variables (#var)</h3>
<div class="toolbar">
  <!-- Template reference variable -->
  <input #box type="text" placeholder="Type something" (input)="current = box.value" />
  <button (click)="read(box.value)">Read value</button>
  <button (click)="box.focus()">Focus input</button>
  <span style="margin-left:8px;color:#666">length={{ box.value.length || 0 }}</span>

  <!-- ViewChild example -->
  <input #text type="button" (click)="addText()" value="Click Me (ViewChild Example)" />
</div>
<p>Current: {{ current }}</p>
<p>text={{ text.value }}</p>

<hr />

<!-- ===============================
     *ngIf with else block
================================== -->
<h3>*ngIf Example</h3>
<div *ngIf="ok; else other">OK</div>
<ng-template #other>Not OK</ng-template>

<hr />

<!-- ===============================
     *ngFor and index usage
================================== -->
<h3>*ngFor Example</h3>
<li *ngFor="let item of items(); index as i">{{ i }} {{ item }}</li>

<hr />

<!-- ===============================
     SELECT BOX + DYNAMIC TEMPLATE OUTLET
================================== -->
<h3>Dynamic ngTemplateOutlet Example</h3>
<select (change)="alert = $any($event.target).value">
  <option value="info">Info</option>
  <option value="warning">Warning</option>
  <option value="danger">Danger</option>
</select>

<input (input)="msg = $any($event.target).value" [value]="msg" placeholder="Type message" />

<!-- Conditional templates -->
<ng-container [ngTemplateOutlet]="alert === 'info' ? infoTpl : (alert === 'warning' ? warnTpl : successTpl)"
  [ngTemplateOutletContext]="{ $implicit: msg }">
</ng-container>

<ng-template #infoTpl let-text>
  <p style="color:royalblue">Info: {{ text }}</p>
</ng-template>

<ng-template #warnTpl let-text>
  <p style="color:darkorange">Warning: {{ text }}</p>
</ng-template>

<ng-template #successTpl let-text>
  <p style="color:seagreen">Success: {{ text }}</p>
</ng-template>

<hr />

<!-- ===============================
     EVENTS & VIEWCHILD USAGE
================================== -->
<h3>Event Binding & ViewChild Example</h3>
<button (click)="count = count + 1">Add Count</button><br />
<button (click)="handleEvent()">Show Count (via ViewChild)</button>

<input #inputtext (input)="text2 = $any($event.target).value" />
<p>text2 = {{ text2 }}</p>

<hr />

<!-- ===============================
     OBJECT TOGGLE AND NULL CHECKS
================================== -->
<h3>Toggle User Object (*ngIf as alias)</h3>
<button (click)="toggle()">Toggle user</button>
<p *ngIf="users as u; else empty">Hello {{ u?.name }}!</p>
<ng-template #empty>No user</ng-template>

<hr />

<!-- ===============================
     PIPE CHAINING
================================== -->
<h3>Pipes and Chaining Example</h3>
<p>Chained: {{ ratio | percent:'1.0-2' | uppercase }}</p>

<!-- Async Pipe Example -->
<ng-container *ngIf="users$ | async as users; else loading">
  <ul>
    <li *ngFor="let u of users">{{ u.name }}</li>
  </ul>
</ng-container>
<ng-template #loading>Loading...</ng-template>

<hr />

<!-- ===============================
     CUSTOM PIPES EXAMPLES
================================== -->
<h3>Custom Pipes</h3>
<p>{{ 'davoodh' | capitalize:3 }}</p>
<p>{{ 'TakaTak' | reverse }}</p>

<hr />

<!-- ===============================
     FILTERING LIST USING SEARCH PIPE
================================== -->
<h3>Search Pipe Example</h3>
<input [(ngModel)]="filter" placeholder="Search fund name" />
<div>
  <li *ngFor="let share of shares | search:filter">
    {{ share.name }} - Expense Ratio: {{ share.expenseratio }}
  </li>
</div>

<hr />

<!-- ===============================
     ATTRIBUTE VS PROPERTY BINDING
================================== -->
<h3>Attribute vs Property Binding</h3>
<input [disabled]="true" /> <!-- property binding -->
<input [attr.disabled]="true" /> <!-- attribute binding -->
<button [attr.aria-label]="btnLabel">Click Me</button>
<div [attr.data-user-id]="123">Div with data-user-id</div>

<hr />

<!-- ===============================
     trackBy Example
================================== -->
<h3>trackBy Example</h3>
<button (click)="shuffle()">Shuffle</button>
<div *ngFor="let it of shares; trackBy: trackById">{{ it.name }}</div>

<hr />

<!-- ===============================
     TWO-WAY DATA BINDING (ngModel)
================================== -->
<h3>Two-way Binding (ngModel)</h3>
<label>
  Name: <input [(ngModel)]="name" placeholder="Type your name" />
</label>

<label style="margin-left:12px">
  Favorite:
  <select [(ngModel)]="favorite">
    <option value="Angular">Angular</option>
    <option value="TypeScript">TypeScript</option>
    <option value="JavaScript">JavaScript</option>
  </select>
</label>

<p>Hello {{ name || 'friend' }}!</p>
<p>Favorite: {{ favorite }}</p>

<hr />

<!-- ===============================
     ATTRIBUTE BINDING (attr.*)
================================== -->
<h3>Attribute Binding (attr.*)</h3>
<div class="toolbar">
  <label>
    Colspan:
    <input type="range" min="1" max="3" [value]="span" (input)="span = +$any($event.target).value" />
    {{ span }}
  </label>

  <label style="margin-left:12px">
    Title:
    <input [value]="title" (input)="title = $any($event.target).value" />
  </label>
</div>

<table [attr.title]="title">
  <thead>
    <tr>
      <th>A</th>
      <th>B</th>
      <th>C</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td [attr.colspan]="span" style="background:#f9fbff">colspan={{ span }}</td>
      <td *ngIf="span < 2">B</td>
      <td *ngIf="span < 3">C</td>
    </tr>
  </tbody>
</table>

<hr />

<!-- ===============================
     *ngIf, *ngFor, ng-template Examples
================================== -->
<h3>Directives Example</h3>
<p *ngIf="items().length > 0">We have {{ items().length }} items</p>
<ul>
  <li *ngFor="let item of items()">{{ item }}</li>
</ul>

<button (click)="toggle()">Toggle Items</button>
<button (click)="loggedIn = !loggedIn">{{ loggedIn ? 'Log out' : 'Log in' }}</button>

<ng-container *ngIf="loggedIn; else loggedOut"></ng-container>
<ng-template #loggedOut>User logged out</ng-template>

<button (click)="hasAccess = !hasAccess">
  Toggle Access ({{ hasAccess ? 'granted' : 'denied' }})
</button>
<ng-container *ngIf="!hasAccess; then accessTpl; else noAccessTpl"></ng-container>

<ng-template #noAccessTpl>
  <p style="color: crimson">Access denied.</p>
</ng-template>

<ng-template #accessTpl>
  <p style="color: seagreen">Access granted.</p>
</ng-template>

<hr />

<!-- ===============================
     EVENT HANDLING EXAMPLES
================================== -->
<h3>Keyboard Events</h3>
<div style="margin-top:12px">
  <input placeholder="Type..." (input)="onInput($event)" (keyup)="lastKey = $any($event).key" />
  <p>Value: {{ value }}</p>
  <p>Last key: {{ lastKey }}</p>
</div>

<label>To Test keyup.enter and keyup:</label>
<input (keyup.enter)="add()" (keyup)="lastKey = $any($event).key" />

<hr />
<h2>Angular Intermediate Concepts</h2>
<h3>Conditional Rendering</h3>
<button (click)="shuffle()">{{button}}</button>
<div>@if (shows()) { <p>Now you see me!</p> } @else { <p>Now I'm hidden.</p> }</div>

<h3>Conditional Rendering with switch</h3>
<label>
  Status:
  <select (change)="status.set($any($event.target).value)">
    <option value="loading">loading</option>
    <option value="success">success</option>
    <option value="error">error</option>
  </select>
</label>

<div>
  @switch (status()) {
  @case ('loading') { <div>
    <p>Loading...</p>
  </div> }
  @case ('success') { <div>
    <p>Success!</p>
  </div> }
  @case ('error') { <div>
    <p>Error!</p>
  </div> }
  }
</div>

<div class="toolbar">
  <button (click)="startLoading()">Start Loading</button>
  <button (click)="showError()">Set Error</button>
  <button (click)="reset()">Reset</button>
  <span style="margin-left:8px;color:#666">loading={{ loadings() }} error={{ error() }}</span>
</div>

@if (!loadings() && !error()) {
<p>Content loaded successfully.</p>
} @else if (loadings()) {
<p>Loading...</p>
} @else {
<p style="color:crimson">Something went wrong.</p>
}

<h1>Lists</h1>
<ul>
  <div>
    @for (item of items(); let i = $index; track item.id){
    <li>{{ i+1 }}.{{item.name}} with id {{item.id}}</li>
    }

    @empty {
    <li>No items</li>
    }
  </div>
</ul>
<button (click)="add()">Add Item</button>
<button (click)="clear()">Clear</button>
<button (click)="reset()">Reset</button>
<button (click)="renameFirst()">Rename first</button>
<button (click)="shuffle2()">Shuffle</button>


<h3>Filter & Sort</h3>
<div style="display:flex;gap:8px;margin-bottom:8px;">
  <label>Search: <input #q (input)="query.set(q.value)" placeholder="Type to filter..." /></label>
  <button (click)="setSort('name')">Sort by Name</button>
  <button (click)="setSort('price')">Sort by Price</button>
  <button (click)="toggleDir()">{{ sortDir() === 1 ? 'Asc' : 'Desc' }}</button>
</div>

<table style="width:100%;border-collapse:collapse;">
  <thead>
    <tr>
      <th style="border:1px solid #ddd;padding:8px;background:#f7f7f7;">Name</th>
      <th style="border:1px solid #ddd;padding:8px;background:#f7f7f7;width:140px;">Price</th>
    </tr>
  </thead>
  <tbody>
    @for (p of view(); track p.name) {
    <tr>
      <td style="border:1px solid #ddd;padding:8px;">{{ p.name }}</td>
      <td style="border:1px solid #ddd;padding:8px;">{{ p.price | currency:'USD' }}</td>
    </tr>
    }
  </tbody>
</table>


<router-outlet></router-outlet>